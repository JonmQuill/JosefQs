<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fullscreen and Microphone Permissions in Iframe</title>
</head>
<body>
    <h1>Parent Page with Iframe</h1>
    <p>Click the button below to load the iframe, request fullscreen, and enable microphone permissions.</p>
    
    <button id="load-iframe-btn">Load Iframe and Go Fullscreen</button>
    
    <!-- Iframe container -->
    <div id="iframe-container" style="display: none; width: 100%; height: 100%; position: fixed; top: 0; left: 0;">
        <iframe 
            id="target-iframe" 
            src="https://studio.intheroom.global/preview/01HME9SDX183TWXP6BPGSDDTF1" 
            style="width: 100%; height: 100%; border: none;"
            allow="microphone" 
            allowfullscreen>
        </iframe>
    </div>
    
    <script>
        const loadIframeButton = document.getElementById('load-iframe-btn');
        const iframeContainer = document.getElementById('iframe-container');
        const iframe = document.getElementById('target-iframe');
        
        // Event listener to load the iframe and request fullscreen
        loadIframeButton.addEventListener('click', async () => {
            try {
                // Request fullscreen for the parent page
                if (document.documentElement.requestFullscreen) {
                    await document.documentElement.requestFullscreen();
                } else {
                    console.warn('Fullscreen API not supported in this browser.');
                }

                // Show the iframe
                iframeContainer.style.display = 'block';

                // Wait for the iframe to load and request fullscreen for the iframe
                iframe.onload = () => {
                    console.log('Iframe loaded, attempting fullscreen...');
                    if (iframe.requestFullscreen) {
                        iframe.requestFullscreen();
                    } else {
                        console.warn('Iframe fullscreen API not supported.');
                    }
                };
            } catch (error) {
                console.error('Error handling fullscreen or iframe:', error);
            }
        });

        // Debug: Log when iframe requests microphone permission (assumes the iframe content has logic to request it)
        window.addEventListener('message', (event) => {
            console.log('Message from iframe:', event.data);
        });
    </script>
</body>
</html>
